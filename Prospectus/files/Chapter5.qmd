\chapter{Approximating the Integrated Likelihood Function}

\section{The Zero-Score Expectation Parameter}

Let $\psi = \varphi(\theta)$ and $\lambda$ denote the parameter of interest and nuisance parameter, respectively, for some statistical model $(\mathcal{S}, \mathcal{P_{\theta}})$. Then the general expression to obtain an integrated likelihood for $\psi$ may be written as $$\bar{L}(\psi) = \int_{\Lambda}L(\psi, \lambda)\pi(\lambda|\psi)d\lambda,$${#eq-IL}
where $\pi(\lambda|\psi)$ is a conditional prior density for $\lambda$ given $\psi$. 

@severini2007 considered the problem of selecting $\pi(\lambda|\psi)$ such that when the likelihood function is integrated with respect to this density, the result is useful for non-Bayesian inference. To do this, he outlined four properties (see Appendix \ref{appendix:B}) that an integrated likelihood function must satisfy if it is to be of any use. He went on to prove that an integrated likelihood satisfying these properties could be obtained by first constructing a new nuisance parameter $\phi \in \Phi$ that is unrelated to the parameter of interest (in the sense that its maximum likelihood estimator remains roughly constant for all values of $\psi$)  and then choosing a prior density $\pi(\phi)$ that is independent of $\psi$. Once chosen, the desired integrated likelihood function for $\psi$ is given by $$\bar{L}(\psi) = \int_{\Phi} \tilde{L}(\psi, \phi) \pi(\phi) d\phi,$${#eq-ZSE_IL1} where $\tilde{L}(\psi, \phi)$ is the likelihood function for the model after it has been reparameterized in terms of $\phi$.  It is important to note that the exact choice of prior density for $\phi$ is not particularly important; the only restriction we place upon it is that it must not depend on $\psi$.  

Suppose that we have an explicit parameter of interest and nuisance parameter, so that $\theta = (\psi, \lambda)$. Then @severini2007 defines this new nuisance parameter $\phi$ as the solution to the equation $$\mathbb{E}(\ell_{\lambda}(\psi, \lambda); \psi_0, \lambda_0)\bigg|_{(\psi_0, \lambda_0) = (\hat{\psi}, \phi)} = 0,$${#eq-zse} where $\ell_{\lambda}(\psi, \lambda) = \frac{\partial \ell(\psi, \lambda)}{\partial \lambda}$, $\psi_0$ and $\lambda_0$ denote the true values of $\psi$ and $\lambda$, and $\hat{\psi}$ is the MLE for $\psi_0$. In other words, for a particular value of $(\psi, \lambda, \hat{\psi})$, we can find the corresponding value of $\phi$ by solving for it in @eq-zse. $\phi$ is called the *zero-score expectation* (ZSE) parameter because it is defined as the value that makes the expectation of the score function (where the derivative is taken with respect to $\lambda$) evaluated at the point $(\hat{\psi}, \phi)$ equal to zero. 

Note that $\phi$ is a function of the data through $\hat{\psi}$. Normally we avoid creating such dependencies in our parameters as it renders them useless for the purpose of parameterizing a statistical model. However, from the perspective of the likelihood function, once the data have been collected they are considered fixed in place and there is no issue with using a quantity such as $\phi$ that depends on the data to parameterize it.

For a given value of $(\psi, \phi, \hat{\psi})$, it is also possible to solve @eq-zse for $\lambda$. This allows us to write @eq-ZSE_IL1 in terms of $L(\psi, \lambda)$: $$\bar{L}(\psi) = \int_{\Phi} L(\psi, \lambda(\psi, \phi)) \pi(\phi) d\phi.$${#eq-ZSE_IL2} 

@severini2018 proved that reparameterizing the nuisance parameter in terms of the ZSE parameter yields the same desirable properties in the subsequent integrated likelihood when $\psi$ and $\lambda$ are implicit. Suppose $\psi$ = $\varphi(\theta)$, for some function $\varphi: \Theta \to \Psi$, and consider the set of all values of $\theta$ satisfying $\varphi(\theta) = \hat{\psi}$. Call this set $\Omega_{\hat{\psi}}$ so that $$\Omega_{\hat{\psi}} = \Big\{\omega \in \Theta: \varphi(\omega) = \hat{\psi}\Big\}.$${#eq-omega_psi_hat} Elements of $\Omega_{\hat{\psi}}$ take the form $(\hat{\psi}, \phi)$, where $\phi \in \Lambda$.

\subsection{Weight Functions}

\section{Two-Index Asymptotics}

Earlier we discussed the one-index asymptotics setting, in which the sample size ($n$) of the model diverged to infinity while the dimension of the nuisance parameter ($q$) remained fixed. Now we turn our attention to the two-index asymptotics setting which describes the behavior of likelihood and pseudolikelihood functions as $n$ and $q$ both tend to infinity, with $q$ growing at least as fast as $n$. Under such a framework, @DeBin2015 showed that estimates for $\psi$ based on a suitably constructed integrated likelihood function will outperform those coming from more traditional pseudolikelihoods, such as the profile likelihood. Such findings provide the motivation for our ensuing examination of two-index asymptotics theory, insofar as it relates to the performance of the integrated likelihood function as a method of inference regarding a parameter of interest.

To mirror the strategy used by @Sartori2003 and @DeBin2015, we will frame our discussion in terms of a stratified sample of data in which each stratum contributes one component to the overall nuisance parameter. Consider a model with parameter $\theta = (\psi, \lambda)$ where $\psi$ is the parameter of interest and $\lambda = (\lambda_1, ..., \lambda_q)$ is a $q$-dimensional nuisance parameter. For the sake of reducing complexity in our notation, we will only consider the case in which $\psi$ and the individual components of $\lambda$ are scalar parameters, though the results of this section should hold in the case where they are all vectors as well. Suppose that we have divided the model's population into $q$ strata and collected a sample of size $m_i$ from each stratum such that observation $j$ from stratum $i$ may be modeled as $$X_{ij} \sim p_{ij}(x_{ij}; \psi, \lambda_i),$${#eq-2idx_model} where $i = 1, ..., q$ and $j = 1, ..., n_i$, making the total sample size $m = \sum_{i = 1}^q m_i$.^[It will be convenient to work under the restriction that the stratum sample sizes are all identical, meaning there exists some positive integer $m$ such that $m_i = m$ for all $i$. However, as both @Sartori2003 and @DeBin2015 note, we could also assume a looser condition in which $m_i = K_i m$ where $0 < K_i < \infty$ without compromising our results.] Hence, there is a one-to-one correspondence between the strata and the components of $\lambda$; assume that each $\lambda_i \in \Lambda$, where the space $\Lambda$ is the same for all $i$, and they all have the same interpretation within their respective strata.

Note that our model does not assume that the observations are i.i.d., and in fact it is possible for the $p_{ij}$'s in @eq-2idx_model to differ from one another. We will also allow for the possibility of dependence among observations within a stratum, though not between them. Let $\mathbf{x}_i = (x_{i1}, ..., x_{im_i})$ denote the sample of observations from stratum $i$, so that their joint density may be written as $p_i(\mathbf{x}_i; \psi, \lambda_i)$. Therefore, the likelihood for the $i$th stratum is $$L^{(i)}(\psi, \lambda_i) = p_i(\mathbf{x}_i; \psi, \lambda_i).$${#eq-2idx_L_i} It follows that the stratum-specific log-likelihood functions have the form $$\ell^{(i)}(\psi, \lambda_i) = \log L^{(i)}(\psi, \lambda_i).$${#eq-2idx_l_i} Let $\hat{\lambda}_{i\psi}$ be the conditional MLE for $\lambda_i$ given $\psi$. The profile likelihood for $\psi$ based on the observations from stratum $i$ is therefore given by $$L_p^{(i)}(\psi) = L^{(i)}(\psi, \hat{\lambda}_{i\psi}).$$ Define the weight function $g(\lambda_i; \psi)$ so that the integrated likelihood for $\psi$ in stratum $i$ is given by $$\bar{L}^{(i)}(\psi) = \int_\Lambda L^{(i)}(\psi, \lambda_i) g(\lambda_i; \psi)d\lambda_i.$${#eq-2_idx_Lbar_i} We can obtain an analytic approximation to $\bar{L}^{(i)}(\psi)$ using a Laplace approximation. To start, let $f(\lambda_i) = L^{(i)}(\psi, \lambda_i) g(\lambda_i; \psi)$ and $h(\lambda_i) = \log f(\lambda_i)$ and consider the second-order Taylor expansion of $h(\lambda_i)$ around $\hat{\lambda}_{i\psi}$: $$h(\lambda_i) = h(\hat{\lambda}_{i\psi}) + h'(\hat{\lambda}_{i\psi})(\lambda_i - \hat{\lambda}_{i\psi}) + \frac{1}{2}h''(\hat{\lambda}_{i\psi})(\lambda_i - \hat{\lambda}_{i\psi})^2 + R$$



A Laplace approximation for $\bar{L}^{(i)}(\psi)$ is 






Since the observations between the strata are independent, we may write the likelihood and log-likelihood functions for the entire model as $$L(\psi, \lambda) = \prod_{i=1}^q L^{(i)}(\psi, \lambda_i)$${#eq-2idx_L} and $$\ell(\psi, \lambda) = \sum_{i=1}^q \ell^{(i)}(\psi, \lambda_i),$${#eq-2idx_l} respectively. We now define the weight function $$G(\lambda; \psi) \equiv \prod_{i=1}^qg(\lambda_i; \psi)$${#eq-2idx_weight} so that the integrated likelihood function for $\psi$ is separable:
$$
\begin{aligned}
\bar{L}(\psi) &= \int_{\Lambda^q}L(\psi, \lambda) G(\lambda; \psi)d\lambda \\
              &= \int_\Lambda\cdots\int_\Lambda \Bigg[\prod_{i=1}^q L^{(i)}(\psi, \lambda_i)\Bigg] \Bigg[\prod_{i=1}^q g(\lambda_i; \psi)\Bigg]d\lambda_1 \cdots d\lambda_q \\
              &= \prod_{i=1}^q \int_\Lambda L^{(i)}(\psi, \lambda_i)g(\lambda_i; \psi)d\lambda_i.
\end{aligned}
$${#eq-2idx_Lbar}






